# PostgreSQL 데이터타입

테이블을 만들 때 상황과 목적에 맞는 데이터 타입을 선택해야 한다.



다양한 데이터 타입 이해 및 형 변환



## 데이터 타입이란?

데이터 타입을 선언해 테이블의 각 컬럼 속에 있는 데이터의 성질을 정의할 수 있음

데이터 타입을 선언할 때 주로 대문자로 표기한다.



많이 쓰이는 데이터 타입

- 숫자형 (Numeric Types)
- 화폐형 (Monetary Types)
- 문자형 (Character Types)
- 날짜 및 시간 (Date & TIme)
- 불리언형 (Boolean Types)
- 배열형 (Array Types)
- 제이슨형 (Json Types)





### 숫자형 (Numeric Types)

- INT (INTEGER)
    - 소수점 자리 제외한 정수만을 입력하길 원할 때
    - 4바이트 크기
    - 표현 범위 : `-2,147,483,648 ~ 2,147,483,647`
- SMALLINT
- BIGINT
- NUMERIC
    - 소수점도 정확히 입력받아야 하는 경우 사용한다.
    - NUMERIC(p,q)
        - p : 전체 자릿수
        - q : 소수점 자릿수
    - 예시) NUMERIC(4,3)
        - 0.001부터 9.999까지 입력 가능
    - NUMERIC(p) : p자리 정수
        - 숫자의 길이를 제한할 때 이런 형태를 씀
- SERIAL
    - 기본 값이 1이며 값이 자동으로 생성되어 1씩 추가된다.
    - pk에 주로 지정
- 등등
- 추가) 표준 SQL엔 DECIMAL이란게 있음
    - postgresql의 NUMERIC과 동일함
    - 소수점 앞 131072자리, 소수점 이후 16383자리까지 저장가능
- 추가) 정확한 소수점 계산이 필요할 때, 부동소수점 활용 연산할 때
    - FLOAT (표준SQL)
    - REAL, DOUBLE PRECISION (postgresql)
        - 정확한 실수 계산을 위해 NUMERIC을 쓰길 권장



정리)

| 데이터 타입  | 설명                                                         | 용량                 |
| ------------ | ------------------------------------------------------------ | -------------------- |
| INTEGER      | 가장 쓰기 적절한 정수형 데이터 타입<br />숫자 길이 제한은 불가하다 | 4 bytes              |
| NUMERIC(p,q) | 소수점자리까지 정할 수 있음<br />DECIMAL과 같음              | 가변적               |
| FLOAT        | 부동소수점을 사용<br />REAL or DOUBLE PRECISION으로 인식     | 4 bytes,<br />8bytes |
| SERIAL       | INTEGER 기본 값으로 1씩 추가되며 값을 자동 생성<br />pk의 데이터타입으로 주로 사용 | 4 bytes              |



### 화폐형 (Monetary Types)

금액을 저장하는 데이터 타입

분수의 형태로 금액을 저장한다.

분수의 정밀도는 lc_monetary 설정을 따른다. (단, 테이블에선 소수점 두 자릿수까지만 표시됨)

로캘(Locale) 설정에 따라 입력 형식이 다르다.

로캘이란?

- 각 나라별로 국가, 지역, 언어코드 등 표시 방법이 다름
- 로캘 식별자를 이용해 각 나라에 맞는 사용자 인터페이스로 변경 가능
- 예시) AWS - Ubuntu EC2에 한국(ko_OR, UTF-8)로 Locale 설정을 해줘야 한국어 관련 서비스를 할 때 문제가 생기지 않는다.



타입

- `MONEY` 



### 문자형 (Character Types)

종류

- VARCHAR(n)
- CHAR(n)
- TEXT

여기서 n은 양의 정수, 데이터의 그기가 아닌 문자열의 길이다.



- VARCHAR(n)
    - character varying의 약자
    - 문자열의 길이가 가변적이다.
    - 지정해준 n 길이까지 담을 수 있는 걸 의미함
    - n을 정의안해주면 임의의 길이의 모든 문자열
- CHAR(n)
    - 지정해준 n의 길이로 고정 할당
    - n=10인데 길이가 5인 데이터를 넣으면 앞에 5개 넣고 나머지 5자리는 공백으로 채워넣는다.
        - CHAR(10) -> 'Hello' ---> 'Hello-----'로 저장되는 것 (-은 공백)
    - n을 정의안해주면 CHAR(1)과 동일하다.

---

- n을 넘어서는 데이터를 넣으면?
    - 오류가 발생하며 최대길이 n에서 문자열이 잘림
- VARCHAR vs. CHAR
    - 주민등록번호, 폰번호 같이 고정길이인 데이터만 CHAR를 쓰고 나머진 VARCHAR를 쓰도록 하자
    - CHAR를 쓰면 빈칸은 공백으로 저장하므로 그만큼 자원낭비
        -> 즉, VARCHAR보다 성능이 느림

---

- TEXT
    - Postgresql에서 지원하는 문자형 데이터 타입
    - 길이 상관없이 문자열을 저장한다
    - 게시글 내용같이 길이가 정해지지 않은 데이터를 담을 때 쓰면 유용하다.



정리)

| 데이터 타입 | 설명                                                        |
| ----------- | ----------------------------------------------------------- |
| VARCHAR(n)  | n 이하 문자의 길이 그대로 저장                              |
| CHAR(n)     | "문자 길이 + 공백" 형태로 n자리 맞춰 저장                   |
| TEXT        | 길이 상관없이 모든 문자열 저장<br />VARCHAR와 동일(n정의 X) |



### 날짜 및 시간

- TIMESTAMP / TIMESTAMPZ
    - (날짜 + 시간) 정보 포함
    - 타임존 포함 X => TIMESTAMP
    - 타임존 포함 O => TIMESTAMPZ
- DATE
    - 날짜 정보만 포함
- TIME / TIME WITH TIME ZONE
    - 시간 정보만 포함





데이터 무결성에 대한 이해

컬럼 값 제한 및 제약조건 적용



