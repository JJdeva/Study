빅데이터 데이터 세트의 저장과 관련된 주요 개념

관계형 데이터베이스 기술과는 다른 특성을 갖음



분산 처리 및 병령 처리 기능 활용해 빅데이터 데이터 세트를 처리하는 방법

맵리듀스(분할 정복 방식 활용)



NoSQL

일괄 처리 및 실시간 처리 모드의 요구사항 -> 온디스크 및 인메모리 저장 옵션의 관점에서 살펴보자

빅데이터 분석 기법 - 정량적, 정성적 분석을 위한 통계적 접근법 / 데이터마이닝, 머신러닝의 컴퓨팅적 접근법





- 클러스터
- 파일 시스템 및 분산 파일 시스템
- NoSQL
- 샤딩
- 복제
- 샤딩 및 복제
- CAP 정리
- ACID
- BASE







외부 소스에서 들어온 데이터는 보통 직접 처리할 수 있는 형식이나 구조가 아님 --> 비호환성 높음

이를 해결하고 저장, 처리를 위한 데이터를 준비하려면 데이터 랭글링(data wrangling)이 필요함



데이터 랭글링엔 다운스트림 분석(downstream analysis)을 위한 데이터 여과, 정제 및 준비 단계가 포함

저장 장치의 관점에서 보면 처음에는 데이터의 복사본이 원본 형식으로 저장되고, 랭글링이 끝나면 처리된 데이터가 다시 저장되는 것이다.

- 외부 데이터 세트를 수집해야 하거나 내부 데이터를 빅데이터 환경에서 사용해야 하는 경우
- 데이터 분석을 위하여 데이터를 처리하는 경우
- 데이터가 ETL 활동을 통해 처리되거나 분석 작업을 통해 결과물이 생성되는 경우

위의 경우 저장장치가 필요하다.



대규모 빅데이터 저장을 위해 낮은 비용과 확장성 높은 저장 솔루션을 구현하기 위한 기술의 베이스

## 1. 클러스터

클러스터(clusters)는 밀접하게 결합된 서버 또는 노드들의 모음

네트워크를 통해 서로 연결되어 하나의 장치처럼 작동한다.

클러스터의 각 노드는 메모리, 프로세서 및 하드 드라이브와 같은 전용 리소스를 가진다.

클러스터를 통해 작업을 보다 세부적인 단위로 분할할 뒤, 포함된 각각의 노드들에게 세부 작업을 할당해 작업을 한꺼번에 수행할 수 있다.



## 2. 파일 시스템 및 분산 파일 시스템

파일 시스템(File System)은 저장 장치에 데이터를 저장하고 구성하는 방법이다.

파일(file)은 파일 시스템이 데이터를 저장하는 데 사용하는 가장 작은 단위

운영체제는 응용 프로그램 대신, 파일 시스템을 사용하여 데이터를 저장하고 검색한다.

각각의 운영체제별 지원하는 파일 시스템의 종류는 같을 수도 있고 다를 수도 있다.



분산 파일 시스템(Distributed File System, DFS)

클러스터 노드에 분산된 대용량 파일을 저장할 수 있는 파일 시스템이다.

대표적인 분산 파일 시스템은 하둡 분산 파일 시스템(Hadoop Distributed File System, HDFS)이다.



## 3. NoSQL

반정형, 비정형 데이터를 수용할 수 있게 설계된 데이터베이스

높은 확장성과 결합 포용성을 가진 비관계형 데이터베이스

API 기반 쿼리 인터페이스 제공 / SQL이외의 쿼리 언어도 지원



## 4. 샤딩

샤딩(sharding)이란 대규모의 데이터 세트를 샤드(shard)라 불리는 더 작고 관리하기 쉬운 데이터 세트로 수평 분할하는 프로세스

샤드는 서버 또는 머신과 같은 같은 여러 노드에 분산되어 저장됨

각 샤드는 분리된 노드에 저장되며 각 노드는 자신에게 저장된 데이터만 담당
각 샤드는 공통의 스키마를 공유하며 모든 샤드를 모으면 전체 데이터 세트가 된다.

각 노드는 전체 데이터 집합의 일부만을 담당하므로 데이터를 읽거나 쓰는 데 걸리는 시간이 크게 감소된다.

- 각 샤드는 독립적으로, 자신이 담당하는 데이터의 특정 부분에 대해 읽기 및 쓰기 작업을 수행할 수 있다.
- 쿼리에 따라 샤드들에서 데이터 가져와 합쳐야 할 수 있음

샤딩의 이점은 데이터베이스 내의 부분적은 결함을 허용할 수 있는 것
하나의 노드에 장애가 발생하는 경우, 해당 노드에 저장된 데이터만 영향을 받고, 다른 노드의 데이터는 그것과 무관하게 다룰 수 있다.

샤드로 데이터를 분할할 때는 샤드 자체가 성능 병목 현상(performance bottleneck)을 일으키지 않도록 하기 위해 쿼리 패턴을 고려해야함
여러 샤드의 데이터가 필요한 쿼리는 성능 저하를 초래하기에 일반적으로 같이 액세스되는 데이터를 단일 샤드에 배치하여 데이터 지역성을 확보해 성능 문제를 해결한다.





## 5. 복제

복제(replication)는 여러 노드에 레플리카(replica)라고 하는 데이터 세트의 복사본을 저장하는 것이다.

동일한 데이터가 다양한 노드에 복제되기 때문에 복제는 확장성과 가용성을 제공함

복제는 개별 노드에 작애가 발생해도 데이터가 손실되지 않도록 하기 때문에 결합 포용성을 얻을 수 있음

복제 구현 방법 2가지

- 마스터 - 슬레이브(Master - Slave)
- 피어 투 피어 (Peer-to-Peer)



### 마스터 슬레이브

- 노드들은 마스터 슬레이브 구성으로 정렬되고, 모든 데이터는 마스터 노드에 써진다.
- 일단 데이터가 마스터 노드에 저장되면 데이터는 여러 슬레이브 노드로 복제된다.
- 추가, 수정 및 삭제를 포함한 모든 외부 쓰기 작업 처리는 마스터 노드에서만 발생
- 읽기 작업은 어떠한 슬레이브에서 발생

마스터 슬레이브 복제는 읽기 요청이 증가해도 수평 스케일링에 슬레이브 노드를 추가하여 처리 가능

반면, 쓰기 작업의 경우, 모든 쓰기 작업을 마스터가 하기때문에 쓰기 요청이 많아지면 성능이 떨어진다.

그래서 읽기 요청이 많은 곳에 쓰기 좋은 복제 방법

마스터 노드에 장애가 나도 다른 슬레이브 노드를 통해 읽기 가능

슬레이브 노드를 마스터 노드의 백업 노드로 만들 수도 있음, 마스터 노드가 죽으면 슬레이브 노드가 마스터 역할을 받고,마스터가 백업가능하면 백업될 때까지 마스터 역할을 대신한다.



비일관성 문제

읽기 작업에서 마스터 노드의 업데이트가 슬레이브 노드로 복사되기 전에 읽기를 시도하면 문제가 될 수 있음

읽기 작업의 일관성을 보장하기 위해 대부분의 슬레이브 노드에 동일한 버전의 데이터가 포함되어 있으면 읽기가 일관된 것으로 선언하는 투표 시스템을 구현할 수 있음 (슬레이브 노드 간에 안정적이고 빠른 통신 메커니즘이 필요)

예시)

1. 사용자가 글을 작성한다.
2. 사용자가 작성한 글을 확인하려고 한다.
3. 마스터 노드에 저장된 글이 슬레이브A로 복사되었다. 사용자가 읽기 요청을 한 곳이 슬레이브B였다. 슬레이브B는 아직 복사를 못했다.
4. 사용자는 쓴 글을 확인하지 못했다.
5. 그 이후 슬레이브B로 마스터 데이터가 복사되었다.






### 피어 투 피어

모든 노드가 동일한 수준에서 작동한다. (노드간 마스터-슬레이브 같은 상하관계가 없음)

피어라고 불리는 각 노드들은 모두 읽기, 쓰기 작업이 가능하다.

한 피어가 쓰기를 받으면 그 데이터를 다른 피어에 동시에 복사한다.

여러 피어 간에 동일한 데이터를 동시에 업데이트함으로써 비일관성 문제가 쉽게 발생한다.
비관적 or 낙관적 동시성 전략을 구현하여 해결할 수 있음

- 비관적 동시성(pessimistic concurrency)
    - 비일관성을 사전에 방지하는 대응 전략으로, 데이터를 한 번에 하나만 업데이트 할 수 있도록 락을 거는 것
    - 락이 풀릴 때까지 업데이트 중인 데이터베이스 데이터를 사용할 수 없으므로 가용성이 좋지 않음
- 낙관적 동시성(optimistic concurrency)
    - 락을 쓰지 않는 사후 대응 전략
    - 비일관성이 발생해도 결국 모든 업데이트가 전파되고 나면 일관성이 유지 될 것이라는 점을 이용함
    - 마스터 슬레이브 처럼 읽기 작업을 할 때 비일관성이 발생이 할 수 있으나 시간이 지나면 결국 일관적이게 된다는 것



## 6. 샤딩 및 복제

샤딩에 의해 제한되는 결함 포용성을 개선하고 복제의 확장성을 추가적으로 얻기 위해 샤딩과 복제, 2방법을 결합한 방식

- 샤딩 및 마스터 슬레이브 복제
- 샤딩 및 피어 투 피어 복제





### 샤딩 및 마스터 슬레이브 복제 결합

마스터가 하나의 샤드고 마스터에 대한 샤드들이 각각 슬레이브가 된다.

책107쪽